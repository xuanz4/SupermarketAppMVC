<nav class="topbar shadow-sm">
  <div class="container d-flex align-items-center justify-content-between">
    <div class="d-flex align-items-center gap-3">
      <% const brandHref = user ? (user.role === 'admin' ? '/inventory' : '/shopping') : '/'; %>
      <a class="brand-mark" href="<%= brandHref %>">SM</a>
      <span class="fw-semibold">Supermarket</span>
    </div>
    <div class="d-flex align-items-center gap-2 flex-wrap justify-content-end">
      <% if (user && user.role !== "admin") { %>
        <a class="nav-chip" href="/orders/history">Orders</a>
        <a class="nav-chip" href="/cart">Cart</a>
      <% } %>
      <% if (user && user.role === "admin") { %>
        <a class="nav-chip" href="/inventory">Inventory</a>
        <a class="nav-chip" href="/admin/users">Users</a>
        <a class="nav-chip" href="/admin/deliveries">Deliveries</a>
      <% } %>
      <% if (user) { %>
        <a class="btn btn-primary" href="/logout">Logout</a>
      <% } else { %>
        <a class="btn btn-primary" href="/login">Login</a>
      <% } %>
    </div>
  </div>
</nav>

<% const successMessages = (typeof messages !== 'undefined' && messages) ? messages : []; %>
<% if (successMessages.length) { %>
  <div class="toast-container position-fixed top-0 start-50 translate-middle-x p-3 mt-3" style="z-index: 1090; min-width: 320px; max-width: 480px;">
    <% successMessages.forEach(function(msg, idx) { %>
      <div class="toast align-items-center text-bg-success border-0 shadow-lg fs-5" role="alert" aria-live="assertive" aria-atomic="true" data-bs-delay="3500" data-autoshow="true" id="toast-success-<%= idx %>">
        <div class="toast-body d-flex align-items-center justify-content-between gap-3">
          <span><%= msg %></span>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
      </div>
    <% }); %>
  </div>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      document.querySelectorAll('.toast[data-autoshow="true"]').forEach(function (toastEl) {
        var toast = new bootstrap.Toast(toastEl);
        toast.show();
      });
    });
  </script>
<% } %>
